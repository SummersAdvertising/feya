
  <link rel="stylesheet" type="text/css" href="/peditor/css/peditor.css">
  <script src="/peditor/js/editor.js"></script>
  <script src="/peditor/js/editor_p.js"></script>
  <script src="/peditor/js/editor_img.js"></script>
  <script src="/peditor/js/editor_list.js"></script>
  <script src="/peditor/js/editor_video.js"></script>


<% if @product.errors.any? %>
<div id="error_explanation">
  <h2><%= pluralize(@product.errors.count, "error") %> prohibited this product from being saved:</h2>

  <ul>
    <% @product.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
    <% end %>
  </ul>
</div>
<% end %>

<div class="new-content">
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td width="50%" valign="top">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="21%">商品名稱：</td>
            <td width="79%"><%= f.text_field :name %></td>
          </tr>
          <tr>
            <td>商品訂價：</td>
            <td><%= f.number_field :price %></td>
          </tr>
          <tr>
            <td>商品折扣價：</td>
            <td><%= f.number_field :saleprice %></td>
          </tr>
          <tr>
            <% if(@product.id) %>
            <td colspan="2">
              <a href="<%= admin_product_stocks_path(@product) %>">編輯商品庫存量</a>
            </td>
            <% end %>
          </tr>
        </table>
      </td>
      <td width="50%" valign="top">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="24%">商品主圖照片</td>
            <td width="76%"><%= f.file_field :cover %></td>
          </tr>
          <tr>
            <td colspan="2" class="preview"><%= (@product.cover && @product.cover.length > 0) ? image_tag(@product.cover) : "尚未上傳產品封面。" %></td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td>產品說明：</td>
    </tr>
    <tr>
      <td>
      	
<div id="editorPanel"></div>

<hr />
<%= fields_for @product.article do | a | %>

	<%= a.hidden_field :content, {:id => 'product_content'} %>

<% end %>
	
<!--show the content of article -->
<section id="articleContent"></section>

<hr />

      
      <%#= f.text_area :description %></td>
    </tr>
  </table>
</div>

<div class="new-send">
  <a href="#" id="submit">確認送出</a>
</div>

<script type="text/javascript">
$("#submit").click(function(){
  $(this).parents("form:first").submit();
});


$(document).ready(function(){
	editor.init({ articleModel: 'product', photoUpload: '../../peditor/<%= @product.article.id %>/createPhoto' });

	$("#submit").click(function(e){
		e.preventDefault();

		if(!editor.isPostNotSent()){
			$("#edit_article_<%= @product.article.id %>").submit();
		}
		else{
			editor.alert("段落編輯尚未完成。", "error");
		}
		
	});
});

</script>